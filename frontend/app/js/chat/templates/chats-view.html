<md-toolbar>
  <div class="md-toolbar-tools md-toolbar-tools-bottom">
    <div class="search-wrapper md-whiteframe-1dp"
         flex
         layout="row"
         layout-align="start center">
      <div class="search"
           flex
           layout="row"
           layout-align="start center">
        <i class="material-icons s18">search</i>
        <input type="text"
               placeholder="Search or start new chat"
               flex
               ng-model="vm.chatSearch">
      </div>
    </div>
  </div>
</md-toolbar>

<md-content
    flex
    ms-scroll>
  <md-list class="chat-list">
    <md-list-item class="contact md-3-line"
                  aria-label="{{ contact.fullName }}"
                  ng-class="{ 'unread': contact.unread }"
                  ng-style="{
                            'transform': ( vm.chatSearch && filteredChat.length > 0 ) ?
                            'translate3d(0px, ' + ($index + 1) * 100 + '%, 0px)':
                            'translate3d(0px, '+ $index* 100 + '%, 0px)',
                            'z-index': filteredChat.length - $index
                            }"
                  ng-repeat="contact in vm.contacts |
                  filter: { fullName: vm.chatSearch } as filteredChat
                  track by contact.id"
                  ng-click="vm.getChat(contact)">
      <div class="avatar-wrapper">
        <div class="md-avatar avatar"
             ng-style="{ 'background-image': 'url(' + (contact.portrait || vm.defaultPortrait) + ')' }">
        </div>
        <i class="material-icons s14 status"
           ng-if="contact.details.isAvailable">check_circle
        </i>
        <i class="material-icons s14 status unavailable"
           ng-if="!contact.details.isAvailable">schedule
        </i>
      </div>
      <div class="md-list-item-text">
        <h3 class="name">
          <span ng-bind="contact.fullName"></span>
        </h3>
        <p class="last-message text-truncate"
           ng-if="contact.lastMessage.text">
          <span ng-bind="contact.lastMessage.text"></span>
        </p>
      </div>
      <div layout="column" layout-align="center end">
        <div class="last-message-time"
             ng-if="contact.lastMessage.updatedAt">
          <span ng-bind="contact.lastMessage.updatedAt | altDate : vm.dateFormat"></span>
        </div>
        <div class="md-accent-bg unread-message-count"
             ng-if="contact.unread">
          <span ng-bind="contact.unread"></span>
        </div>
      </div>
      <md-divider></md-divider>
    </md-list-item>
  </md-list>
  <div class="no-results-message"
       ng-hide="filteredChat.length > 0">No results..
  </div>
</md-content>